FROM golang:1.23-alpine AS builder

WORKDIR /build
COPY cmd/geyser/main.go .
RUN CGO_ENABLED=0 go build -ldflags="-s -w" -o /geyser-entrypoint main.go

FROM eclipse-temurin:21-jre-alpine

RUN apk add --no-cache ca-certificates

COPY --from=builder /geyser-entrypoint /usr/local/bin/geyser-entrypoint

RUN mkdir -p /data /opt/geyser && chmod 755 /data /opt/geyser

EXPOSE 19132/udp

VOLUME /data

ENTRYPOINT ["/usr/local/bin/geyser-entrypoint"]
